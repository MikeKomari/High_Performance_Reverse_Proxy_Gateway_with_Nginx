# Shared memory zone to store request states
limit_req_zone $binary_remote_addr zone=auth_limit:10m rate=5r/s;

# Optional: limit connections
limit_conn_zone $binary_remote_addr zone=auth_conn_limit:10m;